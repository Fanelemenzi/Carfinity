{% extends 'base/base.html'%}
{% load static %}

{% block content %}
<br></br>
{% if user.is_authenticated %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insurance Assessment Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/responsive-claims-dashboard.css' %}" data-critical="true">
    <link rel="stylesheet" href="{% static 'css/notifications.css' %}">
    <link rel="stylesheet" href="{% static 'css/optimized-dashboard.min.css' %}" data-critical="true">
    <link rel="stylesheet" href="{% static 'css/dashboard-integration.css' %}" data-critical="false">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e40af',
                        secondary: '#374151',
                        accent: '#f59e0b',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444'
                    }
                }
            }
        }
    </script>
    <style>
        /* Assessment Dashboard Custom Styles */
        .assessment-card {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .assessment-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .assessment-card:hover::before {
            left: 100%;
        }
        
        .assessment-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .health-index-circle {
            position: relative;
            width: 120px;
            height: 120px;
        }
        
        .health-index-progress {
            transform: rotate(-90deg);
        }
        
        .pulse-dot {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .notification-badge {
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                transform: translate3d(0,-8px,0);
            }
            70% {
                transform: translate3d(0,-4px,0);
            }
            90% {
                transform: translate3d(0,-2px,0);
            }
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .assessment-gradient {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Mobile-First Responsive Design */
        .mobile-nav-toggle {
            display: none;
        }
        
        .mobile-nav-menu {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: white;
            z-index: 1000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        
        .mobile-nav-menu.active {
            transform: translateX(0);
        }
        
        .mobile-nav-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        
        .mobile-nav-overlay.active {
            display: block;
        }
        
        /* Touch-Optimized Controls */
        .touch-target {
            min-height: 44px;
            min-width: 44px;
        }
        
        .swipe-container {
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }
        
        .swipe-item {
            scroll-snap-align: start;
            flex-shrink: 0;
        }
        
        /* Mobile Tablet Breakpoints */
        @media (max-width: 1024px) {
            .desktop-only {
                display: none !important;
            }
            
            .tablet-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tablet-single {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .mobile-nav-toggle {
                display: block;
            }
            
            .desktop-nav {
                display: none;
            }
            
            .mobile-nav-menu {
                display: block;
            }
            
            .mobile-dashboard {
                padding: 1rem;
            }
            
            .mobile-header {
                padding: 0.75rem 1rem;
                position: sticky;
                top: 0;
                z-index: 100;
                background: white;
                border-bottom: 1px solid #e5e7eb;
            }
            
            .mobile-stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
            
            .mobile-action-cards {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .assessment-card {
                margin-bottom: 1rem;
            }
            
            .assessment-card .p-6 {
                padding: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
            }
            
            .mobile-title {
                font-size: 1.5rem;
                line-height: 1.3;
            }
            
            .mobile-subtitle {
                font-size: 0.875rem;
                line-height: 1.4;
            }
            
            .mobile-card {
                border-radius: 0.75rem;
                padding: 1rem;
                margin-bottom: 1rem;
            }
            
            .mobile-card-compact {
                padding: 0.75rem;
                border-radius: 0.5rem;
            }
            
            .mobile-button {
                min-height: 48px;
                padding: 0.75rem 1.5rem;
                font-size: 1rem;
                border-radius: 0.75rem;
                touch-action: manipulation;
            }
            
            .mobile-icon-button {
                min-height: 44px;
                min-width: 44px;
                padding: 0.75rem;
                border-radius: 0.5rem;
            }
        }
        
        @media (max-width: 640px) {
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .welcome-section h2 {
                font-size: 1.25rem;
            }
            
            .mobile-single-column {
                grid-template-columns: 1fr;
            }
            
            .mobile-compact .assessment-card {
                padding: 0.75rem;
            }
            
            .mobile-compact .stats-card {
                padding: 0.75rem;
            }
            
            .mobile-nav-item {
                padding: 1rem;
                border-bottom: 1px solid #f3f4f6;
                font-size: 1.125rem;
            }
            
            .mobile-activity {
                max-height: 300px;
                overflow-y: auto;
            }
            
            .mobile-activity-item {
                padding: 0.75rem;
                border-bottom: 1px solid #f3f4f6;
            }
        }
        
        @media (max-width: 480px) {
            .mobile-dashboard {
                padding: 0.75rem;
            }
            
            .mobile-header {
                padding: 0.5rem 0.75rem;
            }
            
            .mobile-title {
                font-size: 1.25rem;
            }
            
            .mobile-card {
                padding: 0.75rem;
                margin-bottom: 0.75rem;
            }
            
            .mobile-button {
                min-height: 44px;
                padding: 0.625rem 1.25rem;
                font-size: 0.875rem;
            }
        }
        
        /* Visual Indicators */
        .status-indicator {
            position: relative;
        }
        
        .status-indicator::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
        }
        
        .urgent-indicator::after {
            background: #ef4444;
            animation: pulse 1s infinite;
        }
        
        .warning-indicator::after {
            background: #f59e0b;
        }
        
        .card-hover:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .interactive-hover:hover {
            background-color: rgba(59, 130, 246, 0.05);
            border-color: rgba(59, 130, 246, 0.2);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Load essential JavaScript files -->
    <script src="{% static 'js/essential-ui-components.js' %}" defer></script>
    <script src="{% static 'js/claims-table-interactivity.js' %}" defer></script>
    <script src="{% static 'js/workflow-integration-test.js' %}" defer></script>
    
    <!-- Header Navigation -->
    <nav class="dashboard-header mobile-header">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="dashboard-nav">
                <div class="flex items-center">
                    <!-- Mobile Menu Toggle -->
                    <button class="mobile-nav-toggle mobile-icon-button mr-3 text-gray-600 hover:text-gray-900 focus:outline-none md:hidden" id="mobileMenuToggle">
                        <i class="fas fa-bars text-lg"></i>
                    </button>
                    
                    <div class="flex-shrink-0">
                        <a href="{% url 'insurance:assessment_dashboard' %}" class="dashboard-logo">
                            <i class="fas fa-chart-line"></i>
                            <span class="hidden sm:inline">Assessment Dashboard</span>
                            <span class="sm:hidden">Assessments</span>
                        </a>
                    </div>
                    
                    <!-- Desktop Navigation Menu -->
                    <div class="desktop-nav hidden md:block ml-10">
                        <div class="nav-menu">
                            <a href="{% url 'insurance:dashboard' %}" class="nav-item">
                                <i class="fas fa-home mr-2"></i>Dashboard
                            </a>
                            <a href="{% url 'insurance:assessment_dashboard' %}" class="nav-item active">
                                <i class="fas fa-chart-line mr-2"></i>Assessments
                            </a>
                            <a href="{% url 'insurance:book_assessment' %}" class="nav-item">
                                <i class="fas fa-plus-circle mr-2"></i>New Booking
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center space-x-2 md:space-x-4">
                    <!-- Notifications -->
                    <div class="relative" id="notificationBell">
                        <!-- Notification system will be initialized here by JavaScript -->
                    </div>
                    
                    <!-- Agent Profile -->
                    <div class="flex items-center space-x-2 md:space-x-3">
                        <div class="hidden sm:flex flex-col text-right">
                            <span class="text-sm font-medium text-gray-900">{{ user.get_full_name|default:user.username }}</span>
                            <span class="text-xs text-gray-500">Assessment Specialist</span>
                        </div>
                        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                            <i class="fas fa-user text-white text-sm"></i>
                        </div>
                    </div>
                    
                    <div class="hidden lg:flex items-center text-sm text-gray-500">
                        <i class="fas fa-clock mr-1"></i>
                        Last login: <span id="lastLogin">{{ user.last_login|date:"M d, H:i" }}</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Navigation Overlay -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>
    
    <!-- Mobile Navigation Menu -->
    <div class="mobile-nav-menu" id="mobileNavMenu">
        <div class="flex flex-col h-full">
            <!-- Mobile Menu Header -->
            <div class="flex items-center justify-between p-4 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900">Menu</h2>
                <button class="mobile-icon-button text-gray-600 hover:text-gray-900" id="mobileMenuClose">
                    <i class="fas fa-times text-lg"></i>
                </button>
            </div>
            
            <!-- Mobile Menu Items -->
            <div class="flex-1 overflow-y-auto">
                <div class="py-2">
                    <a href="{% url 'insurance:dashboard' %}" class="mobile-nav-item flex items-center text-gray-700 hover:text-gray-900">
                        <i class="fas fa-home mr-3"></i>
                        Dashboard
                    </a>
                    <a href="{% url 'insurance:assessment_dashboard' %}" class="mobile-nav-item flex items-center text-primary font-medium">
                        <i class="fas fa-chart-line mr-3"></i>
                        Assessments
                    </a>
                    <a href="{% url 'insurance:book_assessment' %}" class="mobile-nav-item flex items-center text-gray-700 hover:text-gray-900">
                        <i class="fas fa-plus-circle mr-3"></i>
                        New Booking
                    </a>
                </div>
                
                <!-- Mobile Quick Stats -->
                <div class="border-t border-gray-200 p-4">
                    <h3 class="text-sm font-medium text-gray-900 mb-3">Assessment Stats</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Active Assessments</span>
                            <span class="text-sm font-medium text-gray-900">18</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Pending Reviews</span>
                            <span class="text-sm font-medium text-yellow-600">6</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Urgent Items</span>
                            <span class="text-sm font-medium text-red-600">2</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Menu Footer -->
            <div class="border-t border-gray-200 p-4">
                <div class="flex items-center space-x-3 mb-3">
                    <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center">
                        <i class="fas fa-user text-white"></i>
                    </div>
                    <div>
                        <div class="text-sm font-medium text-gray-900">{{ user.get_full_name|default:user.username }}</div>
                        <div class="text-xs text-gray-500">Assessment Specialist</div>
                    </div>
                </div>
                <button class="w-full mobile-button bg-gray-100 text-gray-700 hover:bg-gray-200">
                    <i class="fas fa-sign-out-alt mr-2"></i>
                    Logout
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto mobile-dashboard px-4 sm:px-6 lg:px-8 py-4 md:py-8">
        <!-- Main Action Cards -->
        <div class="mobile-action-cards grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6 lg:gap-8 mb-6 md:mb-8" data-animate="slide" data-slide-direction="up">
            <!-- Vehicle Health Overview Card -->
            <div class="assessment-card bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-xl shadow-lg border border-indigo-200 hover:shadow-xl transition-all duration-300">
                <div class="p-6 lg:p-8">
                    <div class="flex items-center mb-6">
                        <div class="w-16 h-16 bg-indigo-600 rounded-xl flex items-center justify-center mr-4 shadow-lg">
                            <i class="fas fa-heartbeat text-white text-2xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl lg:text-2xl font-bold text-gray-900 mb-1">Vehicle Health Overview</h3>
                            <p class="text-gray-600 text-sm lg:text-base">Comprehensive health index monitoring</p>
                        </div>
                    </div>
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="health-index-circle relative">
                                <svg class="w-full h-full" viewBox="0 0 120 120">
                                    <circle cx="60" cy="60" r="50" fill="none" stroke="#e5e7eb" stroke-width="8"/>
                                    <circle cx="60" cy="60" r="50" fill="none" stroke="#4f46e5" stroke-width="8" 
                                            stroke-dasharray="314" stroke-dashoffset="47" 
                                            class="health-index-progress transition-all duration-1000"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-indigo-600">85.2%</div>
                                        <div class="text-xs text-gray-500">Health Index</div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex-1 ml-6">
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Critical Systems</span>
                                        <span class="text-sm font-medium text-green-600">92%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Mechanical</span>
                                        <span class="text-sm font-medium text-yellow-600">78%</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Appearance</span>
                                        <span class="text-sm font-medium text-blue-600">88%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="w-full bg-indigo-600 text-white text-center py-3 px-6 rounded-lg font-medium hover:bg-indigo-700 transition-colors duration-200 flex items-center justify-center">
                        <i class="fas fa-chart-bar mr-2"></i>View Detailed Analysis
                    </button>
                </div>
            </div>

            <!-- Assessment Workflow Card -->
            <div class="assessment-card bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl shadow-lg border border-emerald-200 hover:shadow-xl transition-all duration-300">
                <div class="p-6 lg:p-8">
                    <div class="flex items-center mb-6">
                        <div class="w-16 h-16 bg-emerald-600 rounded-xl flex items-center justify-center mr-4 shadow-lg">
                            <i class="fas fa-tasks text-white text-2xl"></i>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-xl lg:text-2xl font-bold text-gray-900 mb-1">Assessment Workflow</h3>
                            <p class="text-gray-600 text-sm lg:text-base">Manage assessment processes</p>
                        </div>
                    </div>
                    <div class="mb-6">
                        <p class="text-gray-700 mb-4 text-sm lg:text-base">Track and manage vehicle assessments through our comprehensive workflow system.</p>
                        <div class="grid grid-cols-2 gap-3 text-sm">
                            <div class="flex items-center bg-white rounded-lg p-2 shadow-sm">
                                <i class="fas fa-play text-emerald-600 mr-2"></i>
                                <span class="text-xs lg:text-sm">Start Assessment</span>
                            </div>
                            <div class="flex items-center bg-white rounded-lg p-2 shadow-sm">
                                <i class="fas fa-clipboard-list text-emerald-600 mr-2"></i>
                                <span class="text-xs lg:text-sm">50-Point Check</span>
                            </div>
                            <div class="flex items-center bg-white rounded-lg p-2 shadow-sm">
                                <i class="fas fa-camera text-emerald-600 mr-2"></i>
                                <span class="text-xs lg:text-sm">Photo Documentation</span>
                            </div>
                            <div class="flex items-center bg-white rounded-lg p-2 shadow-sm">
                                <i class="fas fa-file-alt text-emerald-600 mr-2"></i>
                                <span class="text-xs lg:text-sm">Generate Report</span>
                            </div>
                        </div>
                    </div>
                    <button class="w-full bg-emerald-600 text-white text-center py-3 px-6 rounded-lg font-medium hover:bg-emerald-700 transition-colors duration-200 flex items-center justify-center">
                        <i class="fas fa-arrow-right mr-2"></i>Manage Assessments
                    </button>
                </div>
            </div>
        </div>

        <!-- Assessment Data Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 md:gap-8">
            <!-- Assessment Analytics Panel -->
            <div class="lg:col-span-1">
                <div class="space-y-6">
                    <!-- Health Index Breakdown -->
                    <div class="bg-white rounded-lg shadow p-6 card-hover">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Health Index Breakdown</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Critical Systems:</span>
                                <div class="flex items-center">
                                    <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                        <div class="bg-green-600 h-2 rounded-full" style="width: 92%"></div>
                                    </div>
                                    <span class="text-sm font-medium text-green-600">92%</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Mechanical:</span>
                                <div class="flex items-center">
                                    <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                        <div class="bg-yellow-600 h-2 rounded-full" style="width: 78%"></div>
                                    </div>
                                    <span class="text-sm font-medium text-yellow-600">78%</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Appearance:</span>
                                <div class="flex items-center">
                                    <div class="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                        <div class="bg-blue-600 h-2 rounded-full" style="width: 88%"></div>
                                    </div>
                                    <span class="text-sm font-medium text-blue-600">88%</span>
                                </div>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Overall Index:</span>
                                <span class="text-sm font-medium text-indigo-600">85.2%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Assessment Categories -->
                    <div class="bg-white rounded-lg shadow p-6 card-hover">
                        <h3 class="text-lg font-medium text-gray-900 mb-4">Assessment Categories</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Safety Systems:</span>
                                <span class="text-sm font-medium text-green-600">12 items</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Engine & Drivetrain:</span>
                                <span class="text-sm font-medium text-blue-600">8 items</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Interior/Exterior:</span>
                                <span class="text-sm font-medium text-purple-600">15 items</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Electronics:</span>
                                <span class="text-sm font-medium text-orange-600">6 items</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Claims Table -->
            <div class="lg:col-span-3">
                <div class="bg-white rounded-lg shadow">
                    <!-- Table Header with Filters -->
                    <div class="px-6 py-4 border-b border-gray-200">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0">
                            <h2 class="text-xl font-semibold text-gray-900">All Claims Dashboard</h2>
                            
                            <!-- Filters and Search -->
                            <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4">
                                <!-- Search -->
                                <div class="relative">
                                    <input type="text" 
                                           id="globalSearch"
                                           placeholder="Search claims..." 
                                           class="w-full sm:w-64 pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                           data-search>
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center">
                                        <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                        </svg>
                                    </div>
                                </div>

                                <!-- Status Filter -->
                                <select id="statusFilter" class="border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200" data-filter="status">
                                    <option value="">All Status</option>
                                    <option value="URGENT">Urgent</option>
                                    <option value="REVIEW">Review</option>
                                    <option value="READY">Ready</option>
                                    <option value="PROG">In Progress</option>
                                    <option value="INFO">Info Required</option>
                                </select>

                                <!-- Time Filter -->
                                <select id="dateFilter" class="border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200" data-filter="date">
                                    <option value="">This Month</option>
                                    <option value="today">Today</option>
                                    <option value="week">This Week</option>
                                    <option value="month">This Month</option>
                                    <option value="quarter">This Quarter</option>
                                </select>

                                <!-- Value Filter -->
                                <select id="valueFilter" class="border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200" data-filter="value">
                                    <option value="">All Values</option>
                                    <option value="high">High Value (>¬£25k)</option>
                                    <option value="medium">Medium Value (¬£10k-¬£25k)</option>
                                    <option value="low">Low Value (<¬£10k)</option>
                                </select>
                                
                                <!-- Clear Filters Button -->
                                <button id="clearFilters" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-all duration-200" data-clear-filters>
                                    Clear Filters
                                </button>
                            </div>
                        </div>

                        <!-- Pagination Info -->
                        <div class="mt-4 flex justify-between items-center text-sm text-gray-500">
                            <span id="filterCount" data-filter-count>Showing <span id="visibleCount">5</span> of 5 claims</span>
                            <div class="flex space-x-2">
                                <button class="px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-all duration-200">‚óÄ</button>
                                <span>Page 1 of 1</span>
                                <button class="px-3 py-1 border border-gray-300 rounded hover:bg-gray-50 transition-all duration-200">‚ñ∂</button>
                            </div>
                        </div>
                    </div>

                    <!-- Claims Table -->
                    <div class="overflow-x-auto">
                        <table class="claims-table min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="sortable px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-all duration-200" data-sort="priority">
                                        Priority <i class="sort-icon fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="sortable px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-all duration-200" data-sort="id">
                                        Claim ID <i class="sort-icon fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="sortable px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-all duration-200" data-sort="vehicle">
                                        Vehicle <i class="sort-icon fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="sortable px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-all duration-200" data-sort="value">
                                        Value <i class="sort-icon fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="sortable px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-all duration-200" data-sort="status">
                                        Status <i class="sort-icon fas fa-sort ml-1"></i>
                                    </th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Action</th>
                                </tr>
                            </thead>
                            <tbody id="claimsTableBody" class="bg-white divide-y divide-gray-200" data-sortable-container>
                                {% for assessment in assessments %}
                                <tr class="hover:bg-gray-50 cursor-pointer transition-all duration-200" 
                                    onclick="viewClaim('{{ assessment.assessment_id }}')"
                                    data-claim-id="{{ assessment.assessment_id }}"
                                    data-status="{{ assessment.agent_status|upper }}"
                                    data-priority="{% if assessment.review_deadline and assessment.review_deadline|timeuntil|slice:':1' == '-' %}urgent{% elif assessment.agent_status == 'pending_review' %}review{% elif assessment.agent_status == 'approved' %}ready{% else %}progress{% endif %}"
                                    data-date="{{ assessment.assessment_date|date:'M d' }}"
                                    data-value="{{ assessment.estimated_repair_cost|default:0|floatformat:0 }}"
                                    data-searchable
                                    data-filterable
                                    data-sortable>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            {% if assessment.review_deadline and assessment.review_deadline|timeuntil|slice:':1' == '-' %}
                                                <span class="text-2xl">üî¥</span>
                                            {% elif assessment.agent_status == 'pending_review' %}
                                                <span class="text-2xl">üü°</span>
                                            {% elif assessment.agent_status == 'approved' %}
                                                <span class="text-2xl">üü¢</span>
                                            {% elif assessment.agent_status == 'rejected' %}
                                                <span class="text-2xl">‚ùå</span>
                                            {% elif assessment.agent_status == 'under_review' %}
                                                <span class="text-2xl">üîµ</span>
                                            {% else %}
                                                <span class="text-2xl">‚úÖ</span>
                                            {% endif %}
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="customer-name text-sm font-medium text-gray-900">{{ assessment.assessment_id }}</div>
                                        <div class="text-sm text-gray-500">{{ assessment.assessment_date|date:"M d" }}</div>
                                        <div class="text-sm text-gray-500">{{ assessment.user.get_full_name|default:assessment.user.username }}</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="vehicle-info text-sm font-medium text-gray-900">
                                            {{ assessment.vehicle.year }} {{ assessment.vehicle.make }} {{ assessment.vehicle.model }}
                                        </div>
                                        <div class="text-sm text-gray-500">VIN: {{ assessment.vehicle.vin|default:"N/A" }}</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900">
                                            ¬£{{ assessment.estimated_repair_cost|default:0|floatformat:0 }}
                                        </div>
                                        <div class="text-sm text-gray-500">{{ assessment.get_overall_severity_display }}</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        {% if assessment.agent_status == 'pending_review' %}
                                            <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                                PENDING REVIEW
                                            </span>
                                        {% elif assessment.agent_status == 'under_review' %}
                                            <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                                                UNDER REVIEW
                                            </span>
                                        {% elif assessment.agent_status == 'approved' %}
                                            <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                APPROVED
                                            </span>
                                        {% elif assessment.agent_status == 'rejected' %}
                                            <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">
                                                REJECTED
                                            </span>
                                        {% elif assessment.agent_status == 'changes_requested' %}
                                            <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800">
                                                CHANGES REQUESTED
                                            </span>
                                        {% else %}
                                            <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800">
                                                {{ assessment.get_agent_status_display|upper }}
                                            </span>
                                        {% endif %}
                                        <div class="text-sm text-gray-500">
                                            {% if assessment.review_deadline %}
                                                {{ assessment.review_deadline|timeuntil }}
                                            {% else %}
                                                {{ assessment.assessment_date|timesince }} ago
                                            {% endif %}
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button onclick="event.stopPropagation(); viewClaim('{{ assessment.assessment_id }}')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all duration-200">
                                            <i class="fas fa-arrow-right mr-1"></i>VIEW DETAILS
                                        </button>
                                    </td>
                                </tr>

                                <tr class="hover:bg-gray-50 cursor-pointer transition-all duration-200" 
                                    onclick="viewClaim('INS-8848')"
                                    data-claim-id="INS-8848"
                                    data-status="REVIEW"
                                    data-priority="review"
                                    data-date="Sep 16"
                                    data-value="12500"
                                    data-searchable
                                    data-filterable
                                    data-sortable>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <span class="text-2xl">üü°</span>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="customer-name text-sm font-medium text-gray-900">INS-8848</div>
                                        <div class="text-sm text-gray-500">Sep 16</div>
                                        <div class="text-sm text-gray-500">Brown, M.</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="vehicle-info text-sm font-medium text-gray-900">2021 Audi A4</div>
                                        <div class="text-sm text-gray-500">VIN: WAUZZZF25MA123456</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900">¬£12,500</div>
                                        <div class="text-sm text-gray-500">Moderate</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                            REVIEW
                                        </span>
                                        <div class="text-sm text-gray-500">24h</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button onclick="event.stopPropagation(); viewClaim('INS-8848')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all duration-200">
                                            <i class="fas fa-arrow-right mr-1"></i>VIEW DETAILS
                                        </button>
                                    </td>
                                </tr>

                                <tr class="hover:bg-gray-50 cursor-pointer transition-all duration-200" 
                                    onclick="viewClaim('INS-8849')"
                                    data-claim-id="INS-8849"
                                    data-status="READY"
                                    data-priority="ready"
                                    data-date="Sep 16"
                                    data-value="4200"
                                    data-searchable
                                    data-filterable
                                    data-sortable>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <span class="text-2xl">üü¢</span>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="customer-name text-sm font-medium text-gray-900">INS-8849</div>
                                        <div class="text-sm text-gray-500">Sep 16</div>
                                        <div class="text-sm text-gray-500">Davis, L.</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="vehicle-info text-sm font-medium text-gray-900">2018 Ford Focus</div>
                                        <div class="text-sm text-gray-500">VIN: WF0AXXGCDA123456</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900">¬£4,200</div>
                                        <div class="text-sm text-gray-500">Minor</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                            READY
                                        </span>
                                        <div class="text-sm text-gray-500">2h</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button onclick="event.stopPropagation(); viewClaim('INS-8849')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all duration-200">
                                            <i class="fas fa-arrow-right mr-1"></i>VIEW DETAILS
                                        </button>
                                    </td>
                                </tr>

                                <tr class="hover:bg-gray-50 cursor-pointer transition-all duration-200" 
                                    onclick="viewClaim('INS-8850')"
                                    data-claim-id="INS-8850"
                                    data-status="PROG"
                                    data-priority="progress"
                                    data-date="Sep 17"
                                    data-value="18900"
                                    data-searchable
                                    data-filterable
                                    data-sortable>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <span class="text-2xl">üîµ</span>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="customer-name text-sm font-medium text-gray-900">INS-8850</div>
                                        <div class="text-sm text-gray-500">Sep 17</div>
                                        <div class="text-sm text-gray-500">Wilson, R.</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="vehicle-info text-sm font-medium text-gray-900">2020 Mercedes C-Class</div>
                                        <div class="text-sm text-gray-500">VIN: WDD2053022A123456</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900">¬£18,900</div>
                                        <div class="text-sm text-gray-500">Major</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">
                                            PROG
                                        </span>
                                        <div class="text-sm text-gray-500">12h</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button onclick="event.stopPropagation(); viewClaim('INS-8850')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all duration-200">
                                            <i class="fas fa-arrow-right mr-1"></i>VIEW DETAILS
                                        </button>
                                    </td>
                                </tr>

                                <tr class="hover:bg-gray-50 cursor-pointer transition-all duration-200" 
                                    onclick="viewClaim('INS-8851')"
                                    data-claim-id="INS-8851"
                                    data-status="INFO"
                                    data-priority="info"
                                    data-date="Sep 17"
                                    data-value="8750"
                                    data-searchable
                                    data-filterable
                                    data-sortable>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <span class="text-2xl">üü†</span>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="customer-name text-sm font-medium text-gray-900">INS-8851</div>
                                        <div class="text-sm text-gray-500">Sep 17</div>
                                        <div class="text-sm text-gray-500">Taylor, S.</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="vehicle-info text-sm font-medium text-gray-900">2017 VW Golf</div>
                                        <div class="text-sm text-gray-500">VIN: WVWZZZ1K123456</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="text-sm font-medium text-gray-900">¬£8,750</div>
                                        <div class="text-sm text-gray-500">Moderate</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="status-badge inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800">
                                            INFO
                                        </span>
                                        <div class="text-sm text-gray-500">48h</div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <button onclick="event.stopPropagation(); viewClaim('INS-8851')" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded text-sm transition-all duration-200">
                                            <i class="fas fa-arrow-right mr-1"></i>VIEW DETAILS
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Pagination Controls -->
                    <div id="paginationControls" class="pagination-controls border-t border-gray-200 px-6 py-4">
                        <!-- Pagination will be dynamically generated by JavaScript -->
                    </div>

                    <!-- Status Legend -->
                    <div class="px-6 py-4 bg-gray-50 border-t border-gray-200">
                        <h4 class="text-sm font-medium text-gray-900 mb-2">Status Legend:</h4>
                        <div class="grid grid-cols-2 md:grid-cols-5 gap-2 text-xs">
                            <div class="flex items-center space-x-1">
                                <span class="text-red-500">üî¥</span>
                                <span>URGENT - Immediate attention required</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="text-yellow-500">üü°</span>
                                <span>REVIEW - Pending assessor review</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="text-green-500">üü¢</span>
                                <span>READY - Approved, ready for settlement</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="text-blue-500">üîµ</span>
                                <span>PROG - Assessment in progress</span>
                            </div>
                            <div class="flex items-center space-x-1">
                                <span class="text-orange-500">üü†</span>
                                <span>INFO - Additional information required</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Vanilla JavaScript for Claims Table Functionality
function viewClaim(claimId) {
    // Direct navigation to assessment detail page
    window.location.href = `/insurance/assessments/${claimId}/`;
}

// Global pagination functions
function goToPage(page) {
    if (typeof DashboardInteractivity !== 'undefined' && DashboardInteractivity.goToPage) {
        DashboardInteractivity.goToPage(page);
    } else {
        // Fallback implementation
        window.DashboardState = window.DashboardState || { currentPage: 1, itemsPerPage: 10 };
        window.DashboardState.currentPage = page;
        if (typeof applyPagination === 'function') {
            applyPagination();
        }
    }
}

function changePageSize(pageSize) {
    if (typeof DashboardInteractivity !== 'undefined' && DashboardInteractivity.changePageSize) {
        DashboardInteractivity.changePageSize(pageSize);
    } else {
        // Fallback implementation
        window.DashboardState = window.DashboardState || { currentPage: 1, itemsPerPage: 10 };
        window.DashboardState.itemsPerPage = parseInt(pageSize);
        window.DashboardState.currentPage = 1;
        if (typeof applyPagination === 'function') {
            applyPagination();
        }
    }
}

// Filter and Search Functionality
function initializeClaimsTableFilters() {
    const searchInput = document.getElementById('globalSearch');
    const statusFilter = document.getElementById('statusFilter');
    const dateFilter = document.getElementById('dateFilter');
    const valueFilter = document.getElementById('valueFilter');
    const clearFiltersBtn = document.getElementById('clearFilters');
    const visibleCountSpan = document.getElementById('visibleCount');
    const tableRows = document.querySelectorAll('#claimsTableBody tr[data-searchable]');
    
    function filterTable() {
        const searchTerm = searchInput.value.toLowerCase();
        const statusValue = statusFilter.value;
        const dateValue = dateFilter.value;
        const valueValue = valueFilter.value;
        
        let visibleCount = 0;
        
        tableRows.forEach(row => {
            let isVisible = true;
            
            // Search filter
            if (searchTerm) {
                const claimId = row.dataset.claimId.toLowerCase();
                const customerName = row.querySelector('.customer-name').textContent.toLowerCase();
                const vehicleInfo = row.querySelector('.vehicle-info').textContent.toLowerCase();
                
                if (!claimId.includes(searchTerm) && 
                    !customerName.includes(searchTerm) && 
                    !vehicleInfo.includes(searchTerm)) {
                    isVisible = false;
                }
            }
            
            // Status filter
            if (statusValue && row.dataset.status !== statusValue) {
                isVisible = false;
            }
            
            // Value filter
            if (valueValue) {
                const claimValue = parseInt(row.dataset.value);
                if (valueValue === 'high' && claimValue <= 25000) isVisible = false;
                if (valueValue === 'medium' && (claimValue < 10000 || claimValue > 25000)) isVisible = false;
                if (valueValue === 'low' && claimValue >= 10000) isVisible = false;
            }
            
            // Show/hide row
            if (isVisible) {
                row.style.display = '';
                visibleCount++;
            } else {
                row.style.display = 'none';
            }
        });
        
        // Update visible count
        visibleCountSpan.textContent = visibleCount;
    }
    
    // Event listeners
    searchInput.addEventListener('input', filterTable);
    statusFilter.addEventListener('change', filterTable);
    dateFilter.addEventListener('change', filterTable);
    valueFilter.addEventListener('change', filterTable);
    
    // Clear filters
    clearFiltersBtn.addEventListener('click', function() {
        searchInput.value = '';
        statusFilter.value = '';
        dateFilter.value = '';
        valueFilter.value = '';
        filterTable();
    });
    
    // Initialize table sorting
    initializeTableSorting();
}

// Table Sorting Functionality
function initializeTableSorting() {
    const sortableHeaders = document.querySelectorAll('.sortable');
    let currentSort = { column: null, direction: 'asc' };
    
    sortableHeaders.forEach(header => {
        header.addEventListener('click', function() {
            const sortType = this.dataset.sort;
            const tableBody = document.getElementById('claimsTableBody');
            const rows = Array.from(tableBody.querySelectorAll('tr[data-searchable]'));
            
            // Toggle sort direction
            if (currentSort.column === sortType) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.direction = 'asc';
            }
            currentSort.column = sortType;
            
            // Update sort icons
            sortableHeaders.forEach(h => {
                const icon = h.querySelector('.sort-icon');
                icon.className = 'sort-icon fas fa-sort ml-1';
            });
            
            const currentIcon = this.querySelector('.sort-icon');
            currentIcon.className = `sort-icon fas fa-sort-${currentSort.direction === 'asc' ? 'up' : 'down'} ml-1`;
            
            // Sort rows
            rows.sort((a, b) => {
                let aValue, bValue;
                
                switch (sortType) {
                    case 'priority':
                        const priorityOrder = { urgent: 1, review: 2, progress: 3, ready: 4, info: 5 };
                        aValue = priorityOrder[a.dataset.priority] || 6;
                        bValue = priorityOrder[b.dataset.priority] || 6;
                        break;
                    case 'id':
                        aValue = a.dataset.claimId;
                        bValue = b.dataset.claimId;
                        break;
                    case 'vehicle':
                        aValue = a.querySelector('.vehicle-info').textContent;
                        bValue = b.querySelector('.vehicle-info').textContent;
                        break;
                    case 'value':
                        aValue = parseInt(a.dataset.value);
                        bValue = parseInt(b.dataset.value);
                        break;
                    case 'status':
                        aValue = a.dataset.status;
                        bValue = b.dataset.status;
                        break;
                    default:
                        return 0;
                }
                
                if (typeof aValue === 'string') {
                    return currentSort.direction === 'asc' 
                        ? aValue.localeCompare(bValue)
                        : bValue.localeCompare(aValue);
                } else {
                    return currentSort.direction === 'asc' 
                        ? aValue - bValue
                        : bValue - aValue;
                }
            });
            
            // Reorder rows in DOM
            rows.forEach(row => tableBody.appendChild(row));
        });
    });
}

// Initialize JavaScript components when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    // Initialize claims table filters and sorting
    initializeClaimsTableFilters();
    
    // Initialize pagination
    if (typeof initializePagination === 'function') {
        initializePagination();
    }
    
    // Initialize claims table interactivity
    if (typeof initializeClaimsTable === 'function') {
        initializeClaimsTable();
    }
    
    // Initialize essential UI components
    if (typeof initializeEssentialUIComponents === 'function') {
        initializeEssentialUIComponents();
    }
    
    // Initialize search and filter functionality
    if (typeof initializeSearchAndFilter === 'function') {
        initializeSearchAndFilter();
    }
});
</script>
{% endif %}
{% endblock %}